<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Describing correlation in binary data — lorelogram • lorelogram</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Describing correlation in binary data — lorelogram" />

<meta property="og:description" content="This function calculates a lorelogram for binary data by estimating pairwise log-odds ratios for sampling occasions separated in time or space. The lorelogram depicts pairwise log-odds ratios (y-axis) versus temporal or spatial lag (x-axis) and provides a graphical description of how correlation between outcomes changes as we increase the distance (in space or time) between sampling occasions." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lorelogram</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/lorelogram.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/FabiolaIannarilli/lorelogram">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Describing correlation in binary data</h1>
    <small class="dont-index">Source: <a href='https://github.com/FabiolaIannarilli/lorelogram/blob/master/R/lorelogram.R'><code>R/lorelogram.R</code></a></small>
    <div class="hidden name"><code>lorelogram.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function calculates a lorelogram for binary data by estimating pairwise log-odds ratios for sampling occasions separated in time or space. The lorelogram depicts pairwise log-odds ratios (y-axis) versus temporal or spatial lag (x-axis) and provides a graphical description of how correlation between outcomes changes as we increase the distance (in space or time) between sampling occasions.</p>
    
    </div>

    <pre class="usage"><span class='fu'>lorelogram</span>(<span class='no'>data</span>, <span class='kw'>data_format</span> <span class='kw'>=</span> <span class='st'>"wide"</span>, <span class='kw'>max_lag</span> <span class='kw'>=</span> <span class='fl'>30</span>,
  <span class='kw'>lor_type</span> <span class='kw'>=</span> <span class='st'>"empirical"</span>, <span class='kw'>id_rand_eff</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>lor_adj</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>bin_width</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>plot_LOR</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>write_csv</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>outDir</span> <span class='kw'>=</span> <span class='st'>""</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>data</th>
      <td><p>data.frame containing a sampling unit identifier, binary outcome, and temporal and spatial units associated with each event. Data can be supplied in wide or long format. See Details section below.</p></td>
    </tr>
    <tr>
      <th>data_format</th>
      <td><p>character. Are data organized in "wide" (default) or "long" format? See Details section below.</p></td>
    </tr>
    <tr>
      <th>max_lag</th>
      <td><p>numeric. The maximum spatial or temporal lag between two sampling occasions that should be considered when calculating pairwise log-odds ratios (default: 30).</p></td>
    </tr>
    <tr>
      <th>lor_type</th>
      <td><p>character. Lorelogram can either be estimated using an "empirical" (default) or (glmm) "model-based" approach.</p></td>
    </tr>
    <tr>
      <th>id_rand_eff</th>
      <td><p>logical. Conditional on lor_type = "model-based". Does the model have to include sampling unit ID as random effect (default: FALSE)?</p></td>
    </tr>
    <tr>
      <th>lor_adj</th>
      <td><p>logical. Conditional on lor_type = "empirical". If TRUE (default: FALSE), log-odds ratios are calculated using the adjusted formula. See Details section below.</p></td>
    </tr>
    <tr>
      <th>bin_width</th>
      <td><p>numeric. Number of lags that should be included in each bin. The default (=1) represents no binning.</p></td>
    </tr>
    <tr>
      <th>plot_LOR</th>
      <td><p>logical. Create a plot of the results (default: TRUE)?</p></td>
    </tr>
    <tr>
      <th>write_csv</th>
      <td><p>logical. Should the output be saved as a .csv (default: FALSE)?</p></td>
    </tr>
    <tr>
      <th>outDir</th>
      <td><p>character. Conditional on write_csv = TRUE. Directory into which .csv file is stored.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The function returns a data.frame containing estimates of pairwise log-odds ratios and associated 95% confidence intervals for each lag between 1 and <code>max_lag</code> and a plot of the estimates versus lags (when <code>plot_LOR</code> = TRUE).</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The lorelogram was defined by Heagerty &amp; Zeger (1998) as a graphical tool to describe correlation in binary data and is based on pairwise log-odds ratios. The <code>lorelogram</code> function calculates empirical lorelograms (but see package's vignette for more details on model-based lorelograms).</p>
<p>Log-odds ratios and 95% confidence interval at each lag \(\Deltat\) are calculated as: <p style="text-align:center">LOR=log[<sup>(n<sub>11</sub> n<sub>00</sub>)</sup>&frasl;<sub>(n<sub>10</sub> n<sub>01</sub>)</sub>]</p> and <p style="text-align:center">CI<sup>95%</sup> = LOR &plusmn; &#8730; (<sup>1</sup>&frasl;<sub>n<sub>11</sub></sub> + <sup>1</sup>&frasl;<sub>n<sub>11</sub></sub> + <sup>1</sup>&frasl;<sub>n<sub>11</sub></sub> + <sup>1</sup>&frasl;<sub>n<sub>11</sub></sub>)</p> where, for example, n<sub>11</sub> are the number of 11 pairs (e.g., indicating the species was detected at time t and time t +  \(\Deltat\)). The LOR is  undefined or equals negative infinity when its denominator or numerator is equal to zero; this corresponds to a gap in the lorelogram at that lag. One possible solution is to add 0.5 to all the counts, replacing n<sub>11</sub> with n<sub>11</sub>+0.5 in both equations (Agresti 1990). This option is available setting <code>lor_adj</code> = TRUE. Another option is to bin the data, aggregating time lags. This can be done through the argument <code>bin_width</code>.</p>

<p><code>lorelogram</code> can handle NAs in  <code>data</code>. In the wide format, rows represent sampling units (e.g., camera trap sites or transects) and columns different sampling occassions (e.g., temporal occasions or spatial replicates). <code>data</code> should resemble a binary detection/nondetection history matrix such as that provided  by the function <code><a href='https://rdrr.io/pkg/camtrapR/man/detectionHistory.html'>camtrapR::detectionHistory</a></code>. The first column must contain a unique identifier for each sampling unit; each column from the second to the last must contain the binary data and should follow the spatial or temporal order in which the data were collected (e.g., second, third, and fourth columns should contain data from the first, second, third sampling replicates and so on). If unequal intervals are present in the data,  gaps should be filled with columns of all NAs, so that differences between two subsequent columns (e.g. second and third) corresponds to 1-unit lag. In the long format, <code>data</code> must be organized in three columns, the first containing the sampling unit identifier, the second listing the temporal or spatial unit of the event, and the last column containing the binary outcome (i.e. either 1 or 0).</p>



<p>For more details on data formatting, binning, and model-based lorelograms, see package vignette.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Agresti, A. 1990. Categorical data analysis. Wiley, New York, New York, USA.</p>
<p>Heagerty, P. J., and S. L. Zeger. 1998. Lorelogram: A regression approach to exploring dependence in longitudinal categorical responses. Journal of the American Statistical Association 93:150--162.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='lor_plot.html'>lor_plot</a></code> provides options for saving and customizing the lorelogram plot.
<code><a href='https://rdrr.io/pkg/CompRandFld/man/EVariogram.html'>CompRandFld::EVariogram</a></code> is another function to calculate lorelograms in R.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># calculating lorelogram</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='no'>GrayFox_Hour</span>)
<span class='fu'>lorelogram</span>(<span class='no'>GrayFox_Hour</span>, <span class='kw'>max_lag</span> <span class='kw'>=</span> <span class='fl'>60</span>)</div><div class='img'><img src='lorelogram-1.png' alt='' width='700' height='433' /></div><div class='output co'>#&gt; <span style='color: #555555;'># A tibble: 60 x 4</span><span>
#&gt;      Lag  LORs U_95_CI L_95_CI
#&gt;    </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span> </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>   </span><span style='color: #555555;font-style: italic;'>&lt;dbl&gt;</span><span>
#&gt; </span><span style='color: #555555;'> 1</span><span>     1 2.99     3.41   2.57 
#&gt; </span><span style='color: #555555;'> 2</span><span>     2 1.73     2.41   1.05 
#&gt; </span><span style='color: #555555;'> 3</span><span>     3 2.30     2.84   1.76 
#&gt; </span><span style='color: #555555;'> 4</span><span>     4 2.14     2.71   1.57 
#&gt; </span><span style='color: #555555;'> 5</span><span>     5 1.85     2.50   1.21 
#&gt; </span><span style='color: #555555;'> 6</span><span>     6 1.95     2.57   1.34 
#&gt; </span><span style='color: #555555;'> 7</span><span>     7 1.12     2.01   0.221
#&gt; </span><span style='color: #555555;'> 8</span><span>     8 0.883    1.88  -</span><span style='color: #BB0000;'>0.113</span><span>
#&gt; </span><span style='color: #555555;'> 9</span><span>     9 2.05     2.64   1.45 
#&gt; </span><span style='color: #555555;'>10</span><span>    10 1.73     2.41   1.06 
#&gt; </span><span style='color: #555555;'># ... with 50 more rows</span><span></div><div class='input'>
</div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Fabiola Iannarilli, John R Fieberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


