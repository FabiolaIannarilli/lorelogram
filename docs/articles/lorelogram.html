<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lorelogram: describing correlation structure in binary data • lorelogram</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Lorelogram: describing correlation structure in binary data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">lorelogram</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/lorelogram.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/FabiolaIannarilli/lorelogram">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Lorelogram: describing correlation structure in binary data</h1>
            
            <h4 class="date">18 October 2019</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/FabiolaIannarilli/lorelogram/blob/master/vignettes/lorelogram.Rmd"><code>vignettes/lorelogram.Rmd</code></a></small>
      <div class="hidden name"><code>lorelogram.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>1. Introduction</h1>
<p>The <strong>lorelogram</strong> package provides functions to explore and graphically describe correlation structures in binary data. The package is available on GitHub and can be downloaded in R <span class="citation">(R Core Team 2018)</span> via:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="cf">if</span> (<span class="op">!</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">require</a></span>(<span class="st">"devtools"</span>)) <span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>, </a>
<a class="sourceLine" id="cb1-2" title="2">                                           <span class="dt">repos =</span> <span class="st">"http://cran.us.r-project.org"</span>, </a>
<a class="sourceLine" id="cb1-3" title="3">                                           <span class="dt">dependencies =</span> <span class="st">"Imports"</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">devtools<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/devtools/man/reexports.html">install_github</a></span>(<span class="st">"FabiolaIannarilli/lorelogram"</span>) </a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(lorelogram)</a></code></pre></div>
<p>The lorelogram is a tool to identify dependency structure in binary data. In <span class="citation">Iannarilli et al. (2019)</span>, we showed how it can be used to guide data aggregation efforts to facilitate independence, or alternatively, to inform appropriate structures for modelling correlated data. The method was originally developed by <span class="citation">Heagerty and Zeger (1998)</span> to describe dependence structures in longitudinal categorical data using marginal pairwise conditional log-odds ratios. For details on the method and examples of applications in ecological studies see <span class="citation">Iannarilli et al. (2019)</span>. Here we focus on guiding new users on how to apply the lorelogram to their own dataset.</p>
<p>The main function in the <strong>lorelogram</strong> package is called <code>lorelogram</code>. This function allows users to calculate log-odds ratio at each spatial or temporal lag up to a maximum interval between subsequent observations. It also returns a plot of the log-odds ratio estimates versus lag, the lorelogram plot, that graphically represents how the correlation changes with the increase of the spatial or temporal lag between observations.</p>
<p>We use the data associated with the package to provide a first example. This dataset consists of detection/nondetection data of gray fox (<em>Urocyon cinereoargenteus</em>) collected using camera traps at 100 locations in Northern Minnesota during fall 2016. We provided details on the structure of these data in the <a href="#data-format">Data format</a> section. Further details on the sampling protocol and on all the data provided within the package are available in the READme.txt file at <a href="https://drive.google.com/drive/u/0/folders/12cx59tZvPndOWqH7TG6XKGPFd6HyBjMR" class="uri">https://drive.google.com/drive/u/0/folders/12cx59tZvPndOWqH7TG6XKGPFd6HyBjMR</a> through the University of Minnesota Data Repository DRUM. We load the data and apply the <code>lorelogram</code> function.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"GrayFox_Hour"</span>)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw"><a href="../reference/lorelogram.html">lorelogram</a></span>(GrayFox_Hour, <span class="dt">max_lag =</span> <span class="dv">30</span>)</a></code></pre></div>
<p><img src="lorelogram_files/figure-html/ex1-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code>#&gt; # A tibble: 30 x 4
#&gt;      Lag  LORs U_95_CI L_95_CI
#&gt;    &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
#&gt;  1     1 2.99     3.41   2.57 
#&gt;  2     2 1.73     2.41   1.05 
#&gt;  3     3 2.30     2.84   1.76 
#&gt;  4     4 2.14     2.71   1.57 
#&gt;  5     5 1.85     2.50   1.21 
#&gt;  6     6 1.95     2.57   1.34 
#&gt;  7     7 1.12     2.01   0.221
#&gt;  8     8 0.883    1.88  -0.113
#&gt;  9     9 2.05     2.64   1.45 
#&gt; 10    10 1.73     2.41   1.06 
#&gt; # ... with 20 more rows</code></pre>
<p>The <code>lorelogram</code> function returns a plot of the estimates and a data frame containing the estimated average log-odds ratio values and associate 95% confidence interval at each lag upon to a maximum defined by the argument <code>max_lag</code>. The data frame component of the output can be assigned to an object that can be later used as the argument for the function <code>lor_plot</code>. This second function allows users to save the plot as a jpeg file in a directory of their choice and have more control over plot features. For example, using <code>lor_plot</code> we can assign a title to the plot, change the default label for the x axis and the linetype, specify the color of the 95% confidence interval, the distance between tick marks along the x axis, and the range of the y axis.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">LORs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lorelogram.html">lorelogram</a></span>(GrayFox_Hour, <span class="dt">plot_LOR =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="kw"><a href="../reference/lor_plot.html">lor_plot</a></span>(LORs, <span class="dt">save_LOR_plot =</span> <span class="ot">FALSE</span>, <span class="dt">title =</span> <span class="st">"My first lorelogram"</span>, </a>
<a class="sourceLine" id="cb5-3" title="3">         <span class="dt">x_axis_title =</span> <span class="st">"Lag (Hour)"</span>, <span class="dt">colour=</span><span class="st">"red"</span>, <span class="dt">linetype =</span> <span class="st">"dashed"</span>,</a>
<a class="sourceLine" id="cb5-4" title="4">         <span class="dt">x_break =</span> <span class="dv">24</span>, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="dv">2</span>,<span class="dv">5</span>))</a></code></pre></div>
<p><img src="lorelogram_files/figure-html/ex2-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="how-to-apply-the-lorelogram" class="section level1">
<h1 class="hasAnchor">
<a href="#how-to-apply-the-lorelogram" class="anchor"></a>2. How to apply the lorelogram</h1>
<p>In this section we are going to illustrate <a href="#data-format">how to apply</a> the <code>lorelogram</code> function to new datasets, discuss how to <a href="#interpreting-the-lorelogram">interpret the lorelogram</a>, briefly introduce an <a href="#accounting-for-site-to-site-variability">approach that can account for site-to-site variability while exploring serial dependence</a>, demonstrate the use of <a href="#binning-data">binnning</a>, and show how to determine <a href="#identify-the-minimum-interval-to-approximate-independency">time to independence</a> using a derivative-based approach.</p>
<div id="data-format" class="section level2">
<h2 class="hasAnchor">
<a href="#data-format" class="anchor"></a>2.1 Data format</h2>
<p>The <code>lorelogram</code> function accepts both wide and long data formats. <strong>Wide format</strong> data must contain a sampling unit identifier in the first column and the binary data in the following columns, one column for each sampling occasion. Each row must represent a sampling unit. In the wide format, it is important to order the columns from first to last sampling occasion (with data for the first replicate contained in the second column, second replicate in third column, and so on) because the order of the columns will be used by the function to define the spatial or temporal interval between two outcomes within a sampling unit.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">GrayFox_Hour[<span class="dv">24</span><span class="op">:</span><span class="dv">28</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">31</span>]</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="co">#&gt;     X o1 o2 o3 o4 o5 o6 o7 o8 o9 o10 o11 o12 o13 o14 o15 o16 o17 o18 o19</span></a>
<a class="sourceLine" id="cb6-3" title="3"><span class="co">#&gt; 24 5D  0  0  0  0  0  0  0  0  0   0   0   0   0   0   0   0   0   0   0</span></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">#&gt; 25 5E  0  0  0  0  0  0  0  0  0   0   0   0   0   0   0   0   0   0   0</span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">#&gt; 26 6A NA NA NA NA NA NA NA NA NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA</span></a>
<a class="sourceLine" id="cb6-6" title="6"><span class="co">#&gt; 27 6B NA NA NA NA NA NA NA NA NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA</span></a>
<a class="sourceLine" id="cb6-7" title="7"><span class="co">#&gt; 28 6C NA NA NA NA NA NA NA NA NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA</span></a>
<a class="sourceLine" id="cb6-8" title="8"><span class="co">#&gt;    o20 o21 o22 o23 o24 o25 o26 o27 o28 o29 o30</span></a>
<a class="sourceLine" id="cb6-9" title="9"><span class="co">#&gt; 24   0   0   0   0   0   0   0   0   0   0   0</span></a>
<a class="sourceLine" id="cb6-10" title="10"><span class="co">#&gt; 25   0   0   0   0   0   0   0   0   0   0   0</span></a>
<a class="sourceLine" id="cb6-11" title="11"><span class="co">#&gt; 26  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA</span></a>
<a class="sourceLine" id="cb6-12" title="12"><span class="co">#&gt; 27  NA  NA  NA  NA  NA   0   0   0   0   0   0</span></a>
<a class="sourceLine" id="cb6-13" title="13"><span class="co">#&gt; 28  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA  NA</span></a></code></pre></div>
<p>In this subset of the GrayFox_Hour data, each column after the first records a binary event (1 when the species was detected and 0 otherwise). The subset of the data shown here have been collected at five sites during the first 30 hours of sampling. Note that the columns are ordered from hour 1 (column ‘o1’) to hour 30 (column ‘o30’). NAs indicate occasions in which the camera trap at a certain site was not yet active (e.g., sites 6A and 6C); at site 6B the camera trap was deployed and activated at the 25th hour.</p>
<p>When data are supplied in the <strong>long format</strong>, the dataset must contain three columns organized in the order described here. The first column contains the sampling unit identifier, the second contains numeric values indicating the time or space of each replicate, the last column contains the binary outcome.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"GrayFox_Hour_long"</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">GrayFox_Hour_long[<span class="dv">2501</span><span class="op">:</span><span class="dv">2520</span>,]</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#&gt;      id time  y</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#&gt; 2501 1A   26 NA</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#&gt; 2502 1B   26 NA</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#&gt; 2503 1C   26 NA</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co">#&gt; 2504 1D   26  0</span></a>
<a class="sourceLine" id="cb7-8" title="8"><span class="co">#&gt; 2505 1E   26 NA</span></a>
<a class="sourceLine" id="cb7-9" title="9"><span class="co">#&gt; 2506 2A   26 NA</span></a>
<a class="sourceLine" id="cb7-10" title="10"><span class="co">#&gt; 2507 2B   26 NA</span></a>
<a class="sourceLine" id="cb7-11" title="11"><span class="co">#&gt; 2508 2C   26  0</span></a>
<a class="sourceLine" id="cb7-12" title="12"><span class="co">#&gt; 2509 2D   26  0</span></a>
<a class="sourceLine" id="cb7-13" title="13"><span class="co">#&gt; 2510 2E   26  0</span></a>
<a class="sourceLine" id="cb7-14" title="14"><span class="co">#&gt; 2511 3A   26  0</span></a>
<a class="sourceLine" id="cb7-15" title="15"><span class="co">#&gt; 2512 3B   26 NA</span></a>
<a class="sourceLine" id="cb7-16" title="16"><span class="co">#&gt; 2513 3C   26  0</span></a>
<a class="sourceLine" id="cb7-17" title="17"><span class="co">#&gt; 2514 3D   26 NA</span></a>
<a class="sourceLine" id="cb7-18" title="18"><span class="co">#&gt; 2515 3E   26 NA</span></a>
<a class="sourceLine" id="cb7-19" title="19"><span class="co">#&gt; 2516 4A   26 NA</span></a>
<a class="sourceLine" id="cb7-20" title="20"><span class="co">#&gt; 2517 4B   26 NA</span></a>
<a class="sourceLine" id="cb7-21" title="21"><span class="co">#&gt; 2518 4C   26 NA</span></a>
<a class="sourceLine" id="cb7-22" title="22"><span class="co">#&gt; 2519 4D   26 NA</span></a>
<a class="sourceLine" id="cb7-23" title="23"><span class="co">#&gt; 2520 4E   26 NA</span></a></code></pre></div>
<p>These data are a subset of the same gray fox data used in the previous examples but organized in the long format and show the detection/nondetection outcomes (column ‘y’) at twenty different camera sites (column ‘id’) at the 26th hour of sampling (column ‘time’).</p>
<p>Sites at which there are no detection events (i.e. no 1’s) for the whole sampling period are automatically removed from the dataset because they do not contain information on correlation among detections. The <code>lorelogram</code> function handles missing values (i.e. NAs) in the data; for each sampling unit, these values will be removed before creating the pairwise detection histories at the different intervals.</p>
</div>
<div id="interpreting-the-lorelogram" class="section level2">
<h2 class="hasAnchor">
<a href="#interpreting-the-lorelogram" class="anchor"></a>2.2 Interpreting the lorelogram</h2>
<p>Lorelogram plots provide a graphical description of how the correlation in the data changes with the increase of the interval between sampling occasions. Their interpretation varies depending on the context in which they are applied (e.g., spatial versus temporal dependency). Here we provide some general guidance on how to interpret the lorelogram by applying the function to simulated data. In general, log-odds ratio estimates equal to zero suggest no correlation among outcomes x-units apart. Positive or negative values indicate instead positive or negative correlation, respectively.</p>
<p>We simulate data for 1000 sampling occasions at each of 30 sites, with constant detection for the entire study period. An autocorrelation component of first order (i.e. AR1) determines a short-term dependency in the data, that is, outcomes few lags apart are strongly correlated. We simulate the data and calculate the lorelogram.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># Prepare to simulate</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">129</span>)</a>
<a class="sourceLine" id="cb8-3" title="3">M &lt;-<span class="st"> </span><span class="dv">30</span>                            <span class="co"># Number of sites</span></a>
<a class="sourceLine" id="cb8-4" title="4">J &lt;-<span class="st"> </span><span class="dv">1000</span>                          <span class="co"># Number of occasions</span></a>
<a class="sourceLine" id="cb8-5" title="5">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J)    <span class="co"># to store obs values</span></a>
<a class="sourceLine" id="cb8-6" title="6">time &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">data=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>,J,<span class="dv">1</span>), <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J, <span class="dt">byrow=</span><span class="ot">TRUE</span>) <span class="co"># Create covariate time</span></a>
<a class="sourceLine" id="cb8-7" title="7">b0&lt;-<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">0</span>, J)                      <span class="co"># Stationary mean </span></a>
<a class="sourceLine" id="cb8-8" title="8"></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="co"># Simulate ar1 errors </span></a>
<a class="sourceLine" id="cb8-10" title="10">rho&lt;-<span class="fl">0.75</span> <span class="co"># autocorrelation parameter on logit scale</span></a>
<a class="sourceLine" id="cb8-11" title="11">eps&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J) <span class="co"># to hold errors</span></a>
<a class="sourceLine" id="cb8-12" title="12"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){ <span class="co">#autocorrelation</span></a>
<a class="sourceLine" id="cb8-13" title="13">  eps[i,<span class="dv">1</span><span class="op">:</span>J]&lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span>(<span class="dt">n =</span>J, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">ar =</span> rho), <span class="dt">innov=</span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(J, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">0.5</span>))) </a>
<a class="sourceLine" id="cb8-14" title="14">}</a>
<a class="sourceLine" id="cb8-15" title="15"></a>
<a class="sourceLine" id="cb8-16" title="16"><span class="co"># Determine ps </span></a>
<a class="sourceLine" id="cb8-17" title="17">p &lt;-<span class="st"> </span><span class="kw">inv.logit</span>( <span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(b0, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J, <span class="dt">byrow=</span><span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>eps)   </a>
<a class="sourceLine" id="cb8-18" title="18"></a>
<a class="sourceLine" id="cb8-19" title="19"><span class="co"># Simulate detection process</span></a>
<a class="sourceLine" id="cb8-20" title="20"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>J){</a>
<a class="sourceLine" id="cb8-21" title="21">  y[,j] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(M, <span class="dv">1</span>, p[,j])</a>
<a class="sourceLine" id="cb8-22" title="22">}</a>
<a class="sourceLine" id="cb8-23" title="23"></a>
<a class="sourceLine" id="cb8-24" title="24"><span class="co"># create and add ID column to the data and prepare the data</span></a>
<a class="sourceLine" id="cb8-25" title="25">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dt">id=</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"S"</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>,M,<span class="dv">1</span>), <span class="dt">sep=</span><span class="st">""</span>),y))</a>
<a class="sourceLine" id="cb8-26" title="26"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(y) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"R"</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>, J, <span class="dv">1</span>), <span class="dt">sep=</span><span class="st">""</span>))</a>
<a class="sourceLine" id="cb8-27" title="27">Stat_data &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb8-28" title="28"></a>
<a class="sourceLine" id="cb8-29" title="29"><span class="co"># Applying lorelogram</span></a>
<a class="sourceLine" id="cb8-30" title="30">LOR_Stat_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lorelogram.html">lorelogram</a></span>(Stat_data, <span class="dt">max_lag =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb8-31" title="31"><span class="co">#&gt; Warning in lorelogram(Stat_data, max_lag = 30): Second to last columns in</span></a>
<a class="sourceLine" id="cb8-32" title="32"><span class="co">#&gt; data were converted from factor to numeric</span></a></code></pre></div>
<p><img src="lorelogram_files/figure-html/ex5-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The lorelogram has large positive values for short-time lags, but quickly decreases to 0 for observations <span class="math inline">\(\ge\)</span> 10 units apart. Thus, we conclude that observations exhibit short-term serial dependence and that observations &gt; 10 units apart are approximately independent.</p>
<p>In the second example, we again simulate observations with serial dependence, but we allow the mean to be non-stationary.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co"># Prepare to simulate</span></a>
<a class="sourceLine" id="cb9-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">129</span>)</a>
<a class="sourceLine" id="cb9-3" title="3">M &lt;-<span class="st"> </span><span class="dv">30</span>                            <span class="co"># Number of sites</span></a>
<a class="sourceLine" id="cb9-4" title="4">J &lt;-<span class="st"> </span><span class="dv">1000</span>                          <span class="co"># Number of occasions</span></a>
<a class="sourceLine" id="cb9-5" title="5">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J)    <span class="co"># to store obs values</span></a>
<a class="sourceLine" id="cb9-6" title="6">time &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">data=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>,J,<span class="dv">1</span>), <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J, <span class="dt">byrow=</span><span class="ot">TRUE</span>) <span class="co"># Create covariate time</span></a>
<a class="sourceLine" id="cb9-7" title="7">b0&lt;-<span class="dv">2</span><span class="fl">-0.004</span><span class="op">*</span>time[<span class="dv">1</span>,]               <span class="co"># NON Stationary mean </span></a>
<a class="sourceLine" id="cb9-8" title="8"></a>
<a class="sourceLine" id="cb9-9" title="9"><span class="co"># Simulate ar1 errors </span></a>
<a class="sourceLine" id="cb9-10" title="10">rho&lt;-<span class="fl">0.75</span> <span class="co"># autocorrelation parameter on logit scale</span></a>
<a class="sourceLine" id="cb9-11" title="11">eps&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J) <span class="co"># to hold errors</span></a>
<a class="sourceLine" id="cb9-12" title="12"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){  <span class="co">#autocorrelation</span></a>
<a class="sourceLine" id="cb9-13" title="13">  eps[i,<span class="dv">1</span><span class="op">:</span>J]&lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span>(<span class="dt">n =</span>J, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">ar =</span> rho), <span class="dt">innov=</span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(J, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">0.5</span>)))</a>
<a class="sourceLine" id="cb9-14" title="14">}</a>
<a class="sourceLine" id="cb9-15" title="15"></a>
<a class="sourceLine" id="cb9-16" title="16"><span class="co"># Determine ps </span></a>
<a class="sourceLine" id="cb9-17" title="17">p &lt;-<span class="st"> </span><span class="kw">inv.logit</span>( <span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(b0, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J, <span class="dt">byrow=</span><span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span>eps)   </a>
<a class="sourceLine" id="cb9-18" title="18"></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co"># Simulate detection process</span></a>
<a class="sourceLine" id="cb9-20" title="20"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>J){</a>
<a class="sourceLine" id="cb9-21" title="21">  y[,j] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(M, <span class="dv">1</span>, p[,j])</a>
<a class="sourceLine" id="cb9-22" title="22">}</a>
<a class="sourceLine" id="cb9-23" title="23"></a>
<a class="sourceLine" id="cb9-24" title="24"><span class="co"># create and add ID column to the data and prepare the data</span></a>
<a class="sourceLine" id="cb9-25" title="25">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dt">id=</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"S"</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>,M,<span class="dv">1</span>), <span class="dt">sep=</span><span class="st">""</span>),y))</a>
<a class="sourceLine" id="cb9-26" title="26"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(y) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"R"</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>, J, <span class="dv">1</span>), <span class="dt">sep=</span><span class="st">""</span>))</a>
<a class="sourceLine" id="cb9-27" title="27">NonStat_data &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb9-28" title="28"></a>
<a class="sourceLine" id="cb9-29" title="29"><span class="co"># Applying lorelogram</span></a>
<a class="sourceLine" id="cb9-30" title="30">LOR_NonStat_data &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lorelogram.html">lorelogram</a></span>(NonStat_data, <span class="dt">max_lag =</span> <span class="dv">30</span>)</a>
<a class="sourceLine" id="cb9-31" title="31"><span class="co">#&gt; Warning in lorelogram(NonStat_data, max_lag = 30): Second to last columns</span></a>
<a class="sourceLine" id="cb9-32" title="32"><span class="co">#&gt; in data were converted from factor to numeric</span></a></code></pre></div>
<p><img src="lorelogram_files/figure-html/ex6-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The lorelogram again decreases for the first 10 time lags, but this time the curve levels off at a log-odds ratio value higher than zero. In this case, the non-stationary mean creates a dependence that does not decrease with time between observations. For more discussion and other examples see <span class="citation">Iannarilli et al. (2019)</span> (fig. 2 and S1-2 in Appendix).</p>
<p>Methods to account for this residual correlation exists (see <span class="citation">Iannarilli et al. (2019)</span> section 3 for a list), but these methods are computationally demanding and not yet easy to implement in R. Site-to-site variability, a common source of correlation in ecological data, can be controlled following the approach described in <a href="#accounting-for-site-to-site-variability">section 2.6</a>.</p>
</div>
<div id="how-the-lorelogram-function-works" class="section level2">
<h2 class="hasAnchor">
<a href="#how-the-lorelogram-function-works" class="anchor"></a>2.3 How the <code>lorelogram</code> function works</h2>
<p>The lorelogram requires binary data for 1 or more sampling units (e.g., camera sites). The <code>lorelogram</code> function first removes sampling units that have no 1’s, and, if necessary, converts the binary data from wide to long format (Fig. 1, step A). Then, for each sampling unit, it creates pairs of outcomes <span class="math inline">\(y_{i}\)</span> and <span class="math inline">\(y_{i+\Delta t}\)</span> for all the possible combination of replicates that are between 1 and ≤ <code>max_lag</code> units apart (Fig. 1, step B). The combinations are obtained using the function <code>combinations</code> in package <strong>arrangements</strong> <span class="citation">(Lai 2018)</span>, whereas the pairing is performed using the <code>nest</code> and <code>unnest</code> functions in <strong>tidyverse</strong> <span class="citation">(Wickham 2017)</span>. For each discrete interval (i.e. 1 through <code>max_lag</code>), the function tabulates the number of occurrences of each pairwise detection history ‘11’, ‘10’, ‘01’, or ‘00’ within a sampling unit. These detection histories are then pooled across sampling units (Fig. 1, step C). In the empirical lorelogram, these values are used to calculate the average log-odds ratio value at each interval as: <span class="math display">\[LOR=\log{\frac{n_{11}n_{00}}{n_{01}n_{01}}}.\]</span></p>
<p>The 95% confidence interval at each lag is calculated as: <span class="math display">\[95\% \mbox{ } CI = LOR\pm1.96*\sqrt{\frac{1}{n_{11}}+\frac{1}{n_{00}}+\frac{1}{n_{10}}+\frac{1}{n_{11}}}.\]</span></p>
<div class="figure" style="text-align: center">
<img src="fig_Data_formatting_cropped.jpg" alt=" Figure 1. Conceptual diagram illustrating how the `lorelogram` function works. This example demonstrates how camera trap data are converted from detection histories to the counts used to calculate the lorelogram values (i.e. pairwise log-odds ratios). Detection histories are first converted from wide to long format (A), then the function compiles the outcomes $y_{i}$ and $y_{j}$ as pairwise detections based on all the possible pairwise combinations of time _i_ and _j_ within the maximum time lag ($\Delta t$) considered (B). Finally, for each value of $\Delta t$, the function counts the number of 00, 01, 10, 00 detection histories, pooling pairwise detections across  all sites (C)." width="75%"><p class="caption">
Figure 1. Conceptual diagram illustrating how the <code>lorelogram</code> function works. This example demonstrates how camera trap data are converted from detection histories to the counts used to calculate the lorelogram values (i.e. pairwise log-odds ratios). Detection histories are first converted from wide to long format (A), then the function compiles the outcomes <span class="math inline">\(y_{i}\)</span> and <span class="math inline">\(y_{j}\)</span> as pairwise detections based on all the possible pairwise combinations of time <em>i</em> and <em>j</em> within the maximum time lag (<span class="math inline">\(\Delta t\)</span>) considered (B). Finally, for each value of <span class="math inline">\(\Delta t\)</span>, the function counts the number of 00, 01, 10, 00 detection histories, pooling pairwise detections across all sites (C).
</p>
</div>
</div>
<div id="identify-the-minimum-interval-to-approximate-independence" class="section level2">
<h2 class="hasAnchor">
<a href="#identify-the-minimum-interval-to-approximate-independence" class="anchor"></a>2.4 Identify the minimum interval to approximate independence</h2>
<p>A visual inspection of the lorelogram plot is often sufficient to identify the minimum lag at which serial dependence is no longer present. However, the <strong>lorelogram</strong> package provides the <code>lor_lag_to_indep</code> function to support a more rigorous selection of this threshold. This function requires a data frame containing the output of the <code>lorelogram</code> function. To illustrate how <code>lor_lag_to_indep</code> works, we use the log-odds ratios stored in the object named <em>LOR_NonStat_data</em> and estimated by <code>lorelogram</code> applied to the non-stationary data with short-term dependency structure simulated in <a href="#interpreting-the-lorelogram">section 2.2</a>. We identify the lag at which serial dependence is approximately 0 using the <code>lor_lag_to_indep</code> function.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co">#' Identify interval to reach independency</span></a>
<a class="sourceLine" id="cb10-2" title="2"><span class="kw"><a href="../reference/lor_lag_to_indep.html">lor_lag_to_indep</a></span>(LOR_NonStat_data)</a></code></pre></div>
<p><img src="lorelogram_files/figure-html/ex7-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code>#&gt; 18 
#&gt; 17</code></pre>
<p>In a first step, the <code>lor_lag_to_indep</code> function fits a smoothing cubic spline to the log-odds ratios estimated by the <code>lorelogram</code> function. Then, it calculates the first derivative of the spline curve and identifies the lag at which the derivative is closest to 0 (in absolute value).</p>
</div>
<div id="binning-data" class="section level2">
<h2 class="hasAnchor">
<a href="#binning-data" class="anchor"></a>2.5 Binning data</h2>
<p>The lorelogram is undefined whenever <span class="math inline">\(n_{01}\)</span> or <span class="math inline">\(n_{10}\)</span> is 0 and it is equal to negative infinitiy when either <span class="math inline">\(n_{11}\)</span> or <span class="math inline">\(n_{00}\)</span> is 0. A common strategy to avoid this problem is to apply the alternative formulation <span class="math display">\[LOR=\log{\frac{(n_{11}+0.5)(n_{00}+0.5)}{(n_{10}+0.5)(n_{01}+0.5)}}\]</span> <span class="citation">(Agresti 1990, 54–55)</span>. This formula is used when the <code>lor_adj</code> argument in <code>lorelogram</code> function is set equal to “TRUE”.</p>
<p>Binning the data offers another solution when data are sparse. The choice of bin width represents a bias-variance tradeoff (large bins reduce variance at the cost of introducing bias). See e.g., <a href="https://support.esri.com/en/technical-article/000004923" class="uri">https://support.esri.com/en/technical-article/000004923</a>. Our main goal here, when binning data, is to reduce gaps in the lorelogram when detections are sparse. Using the <code>bin_width</code> argument in <code>lorelogram</code> users can test several binning values and choose the one that they think is most appropriate for their dataset. To illustrate the process we use the gray fox data, this time organized at the minute scale (instead of hour scale), and select only sites where salmon oil was applied as a lure.</p>
<p>We compare results obtained without binning and results obtained using a binning value of 10. The plots illustrate that binning the data is not only helpful to fill in the gaps in the lorelogram, but it also helps in smoothing the curve and reducing the uncertainty in the estimates.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">#' Load data</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(GrayFox_minute_lureSal)</a>
<a class="sourceLine" id="cb12-3" title="3"></a>
<a class="sourceLine" id="cb12-4" title="4"><span class="co"># bin_width = 1 corresponds to no binning</span></a>
<a class="sourceLine" id="cb12-5" title="5"><span class="kw">tic</span>()</a>
<a class="sourceLine" id="cb12-6" title="6">LORs_no_bin &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lorelogram.html">lorelogram</a></span>(GrayFox_minute_lureSal, <span class="dt">max_lag =</span> <span class="dv">60</span>, <span class="dt">bin_width =</span> <span class="dv">1</span>, <span class="dt">plot_LOR =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-7" title="7"><span class="kw">toc</span>()</a>
<a class="sourceLine" id="cb12-8" title="8"><span class="co">#&gt; 752.5 sec elapsed</span></a>
<a class="sourceLine" id="cb12-9" title="9"></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="co"># bin_width = 10</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="kw">tic</span>()</a>
<a class="sourceLine" id="cb12-12" title="12">LORs_<span class="dv">10</span>_bin &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lorelogram.html">lorelogram</a></span>(GrayFox_minute_lureSal, <span class="dt">max_lag =</span> <span class="dv">60</span>, <span class="dt">bin_width =</span> <span class="dv">10</span>, <span class="dt">plot_LOR =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb12-13" title="13"><span class="kw">toc</span>()</a>
<a class="sourceLine" id="cb12-14" title="14"><span class="co">#&gt; 747.44 sec elapsed</span></a>
<a class="sourceLine" id="cb12-15" title="15"></a>
<a class="sourceLine" id="cb12-16" title="16">LORs_no_bin<span class="op">$</span>binning &lt;-<span class="st"> "bin_width = 1"</span></a>
<a class="sourceLine" id="cb12-17" title="17">LORs_<span class="dv">10</span>_bin<span class="op">$</span>binning &lt;-<span class="st"> "bin_width = 10"</span></a>
<a class="sourceLine" id="cb12-18" title="18"></a>
<a class="sourceLine" id="cb12-19" title="19">LORs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(LORs_no_bin, LORs_<span class="dv">10</span>_bin)</a>
<a class="sourceLine" id="cb12-20" title="20"></a>
<a class="sourceLine" id="cb12-21" title="21">LORs <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">binning =</span> <span class="kw"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(binning, <span class="dt">levels =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"bin_width = 1"</span>, <span class="st">"bin_width = 10"</span>))) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb12-22" title="22"><span class="st">  </span><span class="kw">ggplot</span>(., <span class="kw">aes</span>(<span class="dt">x =</span> Lag, <span class="dt">y =</span> LORs))<span class="op">+</span></a>
<a class="sourceLine" id="cb12-23" title="23"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> binning, <span class="dt">color =</span> binning), <span class="dt">size =</span> <span class="fl">0.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb12-24" title="24"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>L_<span class="dv">95</span>_CI, <span class="dt">ymax=</span>U_<span class="dv">95</span>_CI, <span class="dt">color =</span> binning, <span class="dt">fill =</span> binning), <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb12-25" title="25"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-26" title="26"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Log-odds ratio"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-27" title="27"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb12-28" title="28"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.justification =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">legend.position =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.99</span>,<span class="fl">0.99</span>),</a>
<a class="sourceLine" id="cb12-29" title="29">                 <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face =</span> <span class="st">"bold"</span>),</a>
<a class="sourceLine" id="cb12-30" title="30">                 <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>),</a>
<a class="sourceLine" id="cb12-31" title="31">                 <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"white"</span>, <span class="dt">color =</span> <span class="st">"grey"</span>), </a>
<a class="sourceLine" id="cb12-32" title="32">                 <span class="dt">legend.direction =</span> <span class="st">"vertical"</span>,</a>
<a class="sourceLine" id="cb12-33" title="33">                 <span class="dt">axis.line.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(<span class="dt">colour =</span> <span class="st">'black'</span>, <span class="dt">linetype =</span> <span class="st">'solid'</span>),</a>
<a class="sourceLine" id="cb12-34" title="34">                 <span class="dt">axis.ticks.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(<span class="dt">colour =</span> <span class="st">'black'</span>, <span class="dt">linetype =</span> <span class="st">'solid'</span>),</a>
<a class="sourceLine" id="cb12-35" title="35">                 <span class="dt">axis.text =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size=</span><span class="dv">8</span>),</a>
<a class="sourceLine" id="cb12-36" title="36">                 <span class="dt">axis.title =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">face=</span><span class="st">"bold"</span>),</a>
<a class="sourceLine" id="cb12-37" title="37">                 <span class="dt">panel.grid.minor.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb12-38" title="38">                 <span class="dt">panel.grid.major.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb12-39" title="39">                 <span class="dt">panel.grid.major.x =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(<span class="dt">colour =</span> <span class="st">'grey'</span>, <span class="dt">linetype =</span> <span class="st">'solid'</span>,</a>
<a class="sourceLine" id="cb12-40" title="40">                                                            <span class="dt">size=</span><span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb12-41" title="41">                 <span class="dt">panel.grid.minor.x =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(<span class="dt">colour =</span> <span class="st">'grey'</span>, <span class="dt">linetype =</span> <span class="st">'dashed'</span>,</a>
<a class="sourceLine" id="cb12-42" title="42">                                                            <span class="dt">size=</span><span class="fl">0.25</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb12-43" title="43"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="dt">breaks=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(LORs<span class="op">$</span>Lag),<span class="dv">10</span>), <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(LORs<span class="op">$</span>Lag),<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb12-44" title="44"><span class="co">#&gt; Warning: Removed 7 rows containing missing values (geom_path).</span></a></code></pre></div>
<p><img src="lorelogram_files/figure-html/ex8-1.png" width="672" style="display: block; margin: auto;"></p>
</div>
<div id="accounting-for-site-to-site-variability" class="section level2">
<h2 class="hasAnchor">
<a href="#accounting-for-site-to-site-variability" class="anchor"></a>2.6 Accounting for site-to-site variability</h2>
<p>A common source of correlation in ecological studies is due to variability among sites (i.e. sampling units). Similar to the non-stationary example in <a href="#interpreting-the-lorelogram">section 2.2</a>, site-to-site variability will cause the lorelogram to level off at a log-odds ratio higher than zero. Interestingly, we can adjust for this dependence using a generalized linear mixed model approach that includes sampling units as a random effect. Thus, we provide the option to adopt this method in <code>lorelogram</code> by setting the argument <code>lor_type</code> equal to <code>model-based</code> and the argument <code>id_rand_eff</code> equal to <code>TRUE</code>. We illustrate the process using simulated data containing a short term correlation structure (that is targeted by the lorelogram) and a non-serial component due to site-to-site variability.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="co"># Prepare to simulate</span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="dv">129</span>)</a>
<a class="sourceLine" id="cb13-3" title="3">M &lt;-<span class="st"> </span><span class="dv">30</span>                            <span class="co"># Number of sites</span></a>
<a class="sourceLine" id="cb13-4" title="4">J &lt;-<span class="st"> </span><span class="dv">1000</span>                          <span class="co"># Number of occasions</span></a>
<a class="sourceLine" id="cb13-5" title="5">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J)    <span class="co"># to store obs values</span></a>
<a class="sourceLine" id="cb13-6" title="6">time &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="dt">data=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>,J,<span class="dv">1</span>), <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J, <span class="dt">byrow=</span><span class="ot">TRUE</span>) <span class="co"># Create covariate time</span></a>
<a class="sourceLine" id="cb13-7" title="7">b0&lt;-<span class="kw"><a href="https://rdrr.io/r/base/rep.html">rep</a></span>(<span class="dv">0</span>, J)                      <span class="co"># Stationary mean </span></a>
<a class="sourceLine" id="cb13-8" title="8"></a>
<a class="sourceLine" id="cb13-9" title="9"><span class="co"># Simulate site-to-site variability</span></a>
<a class="sourceLine" id="cb13-10" title="10">sdtau&lt;-<span class="fl">0.8</span>     <span class="co"># site-level variability</span></a>
<a class="sourceLine" id="cb13-11" title="11">taus&lt;-<span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(M, <span class="dv">0</span>, sdtau)</a>
<a class="sourceLine" id="cb13-12" title="12"></a>
<a class="sourceLine" id="cb13-13" title="13"><span class="co"># Simulate ar1 errors (pick whichever is appropriate)</span></a>
<a class="sourceLine" id="cb13-14" title="14">rho&lt;-<span class="fl">0.75</span> <span class="co"># autocorrelation parameter on logit scale</span></a>
<a class="sourceLine" id="cb13-15" title="15">eps&lt;-<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(<span class="ot">NA</span>, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J) <span class="co"># to hold errors</span></a>
<a class="sourceLine" id="cb13-16" title="16"><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>M){ <span class="co">#autocorrelation</span></a>
<a class="sourceLine" id="cb13-17" title="17">  eps[i,<span class="dv">1</span><span class="op">:</span>J]&lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/t.html">t</a></span>(<span class="kw"><a href="https://rdrr.io/r/stats/arima.sim.html">arima.sim</a></span>(<span class="dt">n =</span>J, <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="dt">ar =</span> rho), <span class="dt">innov=</span><span class="kw"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span>(J, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd=</span><span class="fl">0.5</span>))) </a>
<a class="sourceLine" id="cb13-18" title="18">}</a>
<a class="sourceLine" id="cb13-19" title="19"></a>
<a class="sourceLine" id="cb13-20" title="20"><span class="co"># Determine ps </span></a>
<a class="sourceLine" id="cb13-21" title="21">p &lt;-<span class="st"> </span><span class="kw">inv.logit</span>(<span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(b0, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J, <span class="dt">byrow=</span><span class="ot">TRUE</span>) <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span>(taus, <span class="dt">nrow=</span>M, <span class="dt">ncol=</span>J, <span class="dt">byrow=</span><span class="ot">FALSE</span>) </a>
<a class="sourceLine" id="cb13-22" title="22">                <span class="op">+</span><span class="st"> </span>eps)   </a>
<a class="sourceLine" id="cb13-23" title="23"></a>
<a class="sourceLine" id="cb13-24" title="24"><span class="co"># Simulate detection process</span></a>
<a class="sourceLine" id="cb13-25" title="25"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>J){</a>
<a class="sourceLine" id="cb13-26" title="26">  y[,j] &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/Binomial.html">rbinom</a></span>(M, <span class="dv">1</span>, p[,j])</a>
<a class="sourceLine" id="cb13-27" title="27">}</a>
<a class="sourceLine" id="cb13-28" title="28"></a>
<a class="sourceLine" id="cb13-29" title="29"><span class="co"># create and add ID column to the data and prepare the data</span></a>
<a class="sourceLine" id="cb13-30" title="30">y &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span>(<span class="dt">id=</span><span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"S"</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>,M,<span class="dv">1</span>), <span class="dt">sep=</span><span class="st">""</span>),y))</a>
<a class="sourceLine" id="cb13-31" title="31"><span class="kw"><a href="https://rdrr.io/r/base/colnames.html">colnames</a></span>(y) &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"id"</span>, <span class="kw"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"R"</span>, <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">1</span>, J, <span class="dv">1</span>), <span class="dt">sep=</span><span class="st">""</span>))</a>
<a class="sourceLine" id="cb13-32" title="32">Site_var_data &lt;-<span class="st"> </span>y</a>
<a class="sourceLine" id="cb13-33" title="33"></a>
<a class="sourceLine" id="cb13-34" title="34"><span class="co"># Applying empirical lorelogram</span></a>
<a class="sourceLine" id="cb13-35" title="35"><span class="kw">tic</span>()</a>
<a class="sourceLine" id="cb13-36" title="36">LOR_empirical &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lorelogram.html">lorelogram</a></span>(Site_var_data &lt;-<span class="st"> </span>y, <span class="dt">max_lag =</span> <span class="dv">30</span>, <span class="dt">lor_type =</span> <span class="st">"empirical"</span>, <span class="dt">plot_LOR =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-37" title="37"><span class="co">#&gt; Warning in lorelogram(Site_var_data &lt;- y, max_lag = 30, lor_type =</span></a>
<a class="sourceLine" id="cb13-38" title="38"><span class="co">#&gt; "empirical", : Second to last columns in data were converted from factor to</span></a>
<a class="sourceLine" id="cb13-39" title="39"><span class="co">#&gt; numeric</span></a>
<a class="sourceLine" id="cb13-40" title="40"><span class="kw">toc</span>()</a>
<a class="sourceLine" id="cb13-41" title="41"><span class="co">#&gt; 7.09 sec elapsed</span></a>
<a class="sourceLine" id="cb13-42" title="42">plot_emp &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lor_plot.html">lor_plot</a></span>(LOR_empirical, <span class="dt">colour =</span> <span class="st">"green"</span>, <span class="dt">title =</span> <span class="st">"Empirical"</span>, <span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">0.05</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb13-43" title="43"></a>
<a class="sourceLine" id="cb13-44" title="44"><span class="co"># Applying model-based lorelogram without random effect</span></a>
<a class="sourceLine" id="cb13-45" title="45"><span class="kw">tic</span>()</a>
<a class="sourceLine" id="cb13-46" title="46">LOR_mod_noRE &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lorelogram.html">lorelogram</a></span>(Site_var_data &lt;-<span class="st"> </span>y, <span class="dt">max_lag =</span> <span class="dv">30</span>, <span class="dt">lor_type =</span> <span class="st">"model-based"</span>, </a>
<a class="sourceLine" id="cb13-47" title="47">                           <span class="dt">id_rand_eff =</span> <span class="ot">FALSE</span>, <span class="dt">plot_LOR =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-48" title="48"><span class="co">#&gt; Warning in lorelogram(Site_var_data &lt;- y, max_lag = 30, lor_type = "model-</span></a>
<a class="sourceLine" id="cb13-49" title="49"><span class="co">#&gt; based", : Second to last columns in data were converted from factor to</span></a>
<a class="sourceLine" id="cb13-50" title="50"><span class="co">#&gt; numeric</span></a>
<a class="sourceLine" id="cb13-51" title="51"><span class="kw">toc</span>()</a>
<a class="sourceLine" id="cb13-52" title="52"><span class="co">#&gt; 73.12 sec elapsed</span></a>
<a class="sourceLine" id="cb13-53" title="53"></a>
<a class="sourceLine" id="cb13-54" title="54"><span class="co"># Applying model-based lorelogram without random effect</span></a>
<a class="sourceLine" id="cb13-55" title="55"><span class="kw">tic</span>()</a>
<a class="sourceLine" id="cb13-56" title="56">LOR_mod_RE &lt;-<span class="st"> </span><span class="kw"><a href="../reference/lorelogram.html">lorelogram</a></span>(Site_var_data &lt;-<span class="st"> </span>y, <span class="dt">max_lag =</span> <span class="dv">30</span>, <span class="dt">lor_type =</span> <span class="st">"model-based"</span>, </a>
<a class="sourceLine" id="cb13-57" title="57">                         <span class="dt">id_rand_eff =</span> <span class="ot">TRUE</span>, <span class="dt">plot_LOR =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb13-58" title="58"><span class="co">#&gt; Warning in lorelogram(Site_var_data &lt;- y, max_lag = 30, lor_type = "model-</span></a>
<a class="sourceLine" id="cb13-59" title="59"><span class="co">#&gt; based", : Second to last columns in data were converted from factor to</span></a>
<a class="sourceLine" id="cb13-60" title="60"><span class="co">#&gt; numeric</span></a>
<a class="sourceLine" id="cb13-61" title="61"><span class="co">#&gt; Warning in fitTMB(TMBStruc): Model convergence problem; function evaluation</span></a>
<a class="sourceLine" id="cb13-62" title="62"><span class="co">#&gt; limit reached without convergence (9). See vignette('troubleshooting')</span></a>
<a class="sourceLine" id="cb13-63" title="63"><span class="kw">toc</span>()</a>
<a class="sourceLine" id="cb13-64" title="64"><span class="co">#&gt; 82.04 sec elapsed</span></a>
<a class="sourceLine" id="cb13-65" title="65"></a>
<a class="sourceLine" id="cb13-66" title="66">LOR_mod_noRE<span class="op">$</span>Method &lt;-<span class="st"> "Model - no site effect"</span></a>
<a class="sourceLine" id="cb13-67" title="67">LOR_mod_RE<span class="op">$</span>Method &lt;-<span class="st"> "Model - with site effect"</span></a>
<a class="sourceLine" id="cb13-68" title="68"></a>
<a class="sourceLine" id="cb13-69" title="69">LORs &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/cbind.html">rbind</a></span>(LOR_mod_noRE, LOR_mod_RE)</a>
<a class="sourceLine" id="cb13-70" title="70"></a>
<a class="sourceLine" id="cb13-71" title="71">plot_mod &lt;-<span class="st"> </span><span class="kw">ggplot</span>(LORs, <span class="kw">aes</span>(<span class="dt">x =</span> Lag, <span class="dt">y =</span> LORs))<span class="op">+</span></a>
<a class="sourceLine" id="cb13-72" title="72"><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">linetype =</span> Method, <span class="dt">color =</span> Method), <span class="dt">size =</span> <span class="fl">0.5</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb13-73" title="73"><span class="st">  </span><span class="kw">geom_ribbon</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>L_<span class="dv">95</span>_CI, <span class="dt">ymax=</span>U_<span class="dv">95</span>_CI, <span class="dt">color =</span> Method, <span class="dt">fill =</span> Method), <span class="dt">alpha=</span><span class="fl">0.7</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb13-74" title="74"><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept =</span> <span class="dv">0</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-75" title="75"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">"Log-odds ratio"</span>, <span class="dt">title =</span> <span class="st">"Model-based"</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-76" title="76"><span class="st">  </span><span class="kw">coord_cartesian</span>(<span class="dt">ylim =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="op">-</span><span class="fl">0.05</span>,<span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb13-77" title="77"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb13-78" title="78"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span>(<span class="dt">legend.justification =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>, <span class="dv">1</span>), <span class="dt">legend.position =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.99</span>,<span class="fl">0.99</span>),</a>
<a class="sourceLine" id="cb13-79" title="79">                 <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">10</span>, <span class="dt">face =</span> <span class="st">"bold"</span>),</a>
<a class="sourceLine" id="cb13-80" title="80">                 <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">8</span>),</a>
<a class="sourceLine" id="cb13-81" title="81">                 <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(<span class="dt">fill =</span> <span class="st">"white"</span>, <span class="dt">color =</span> <span class="st">"grey"</span>), </a>
<a class="sourceLine" id="cb13-82" title="82">                 <span class="dt">legend.direction =</span> <span class="st">"vertical"</span>,</a>
<a class="sourceLine" id="cb13-83" title="83">                 <span class="dt">axis.line.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(<span class="dt">colour =</span> <span class="st">'black'</span>, <span class="dt">linetype =</span> <span class="st">'solid'</span>),</a>
<a class="sourceLine" id="cb13-84" title="84">                 <span class="dt">axis.ticks.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(<span class="dt">colour =</span> <span class="st">'black'</span>, <span class="dt">linetype =</span> <span class="st">'solid'</span>),</a>
<a class="sourceLine" id="cb13-85" title="85">                 <span class="dt">axis.text =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size=</span><span class="dv">8</span>),</a>
<a class="sourceLine" id="cb13-86" title="86">                 <span class="dt">axis.title =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_text</a></span>(<span class="dt">size=</span><span class="dv">10</span>,<span class="dt">face=</span><span class="st">"bold"</span>),</a>
<a class="sourceLine" id="cb13-87" title="87">                 <span class="dt">panel.grid.minor.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb13-88" title="88">                 <span class="dt">panel.grid.major.y =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_blank</a></span>(),</a>
<a class="sourceLine" id="cb13-89" title="89">                 <span class="dt">panel.grid.major.x =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(<span class="dt">colour =</span> <span class="st">'grey'</span>, <span class="dt">linetype =</span> <span class="st">'solid'</span>,</a>
<a class="sourceLine" id="cb13-90" title="90">                                                            <span class="dt">size=</span><span class="fl">0.25</span>),</a>
<a class="sourceLine" id="cb13-91" title="91">                 <span class="dt">panel.grid.minor.x =</span> ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/element.html">element_line</a></span>(<span class="dt">colour =</span> <span class="st">'grey'</span>, <span class="dt">linetype =</span> <span class="st">'dashed'</span>,</a>
<a class="sourceLine" id="cb13-92" title="92">                                                            <span class="dt">size=</span><span class="fl">0.25</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb13-93" title="93"><span class="st">  </span>ggplot2<span class="op">::</span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_continuous</a></span>(<span class="dt">breaks=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(LORs<span class="op">$</span>Lag),<span class="dv">10</span>), <span class="dt">labels=</span><span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>,<span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span>(LORs<span class="op">$</span>Lag),<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb13-94" title="94"></a>
<a class="sourceLine" id="cb13-95" title="95"><span class="kw">grid.arrange</span>(plot_emp, plot_mod, <span class="dt">ncol =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="lorelogram_files/figure-html/ex9-1.png" width="672" style="display: block; margin: auto;"></p>
<p>When estimating the empirical lorelogram, the lorelogram curve levels off at a log-odds ratio value higher than zero, even when data are stationary, due to the site-to-site variability. However, when applying the model-based approach including sampling units as random effect, the correlation due to site-to-site variability is removed.</p>
</div>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-Agresti1990">
<p>Agresti, Alan. 1990. <em>Categorical data analysis</em>. New York, New York, USA: Wiley.</p>
</div>
<div id="ref-Heagerty1998">
<p>Heagerty, Patrick J., and Scott L. Zeger. 1998. “Lorelogram: A regression approach to exploring dependence in longitudinal categorical responses.” <em>Journal of the American Statistical Association</em> 93 (441): 150–62. <a href="https://doi.org/10.2307/2669612">https://doi.org/10.2307/2669612</a>.</p>
</div>
<div id="ref-Iannarilli">
<p>Iannarilli, F, Todd W. Arnold, John Erb, and John R. Fieberg. 2019. “Using lorelograms to measure and model correlation in binary data: Applications to ecological studies.” <em>Methods in Ecology and Evolution</em>.</p>
</div>
<div id="ref-Lai2018">
<p>Lai, Randy. 2018. “arrangements: Fast Generators and Iterators for Permutations, Combinations and Partitions.” <a href="https://cran.r-project.org/package=arrangements">https://cran.r-project.org/package=arrangements</a>.</p>
</div>
<div id="ref-RCoreTeam2018">
<p>R Core Team. 2018. “R: A language and environment for statistical computing.” Vienna, Austria: R Foundation for Statistical Computing. <a href="https://www.r-project.org/.">https://www.r-project.org/.</a></p>
</div>
<div id="ref-Hadley2017">
<p>Wickham, Hadley. 2017. “tidyverse: Easily Install and Load the ’Tidyverse’.” <a href="https://cran.r-project.org/package=tidyverse">https://cran.r-project.org/package=tidyverse</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">1. Introduction</a></li>
      <li>
<a href="#how-to-apply-the-lorelogram">2. How to apply the lorelogram</a><ul class="nav nav-pills nav-stacked">
<li><a href="#data-format">2.1 Data format</a></li>
      <li><a href="#interpreting-the-lorelogram">2.2 Interpreting the lorelogram</a></li>
      <li><a href="#how-the-lorelogram-function-works">2.3 How the <code>lorelogram</code> function works</a></li>
      <li><a href="#identify-the-minimum-interval-to-approximate-independence">2.4 Identify the minimum interval to approximate independence</a></li>
      <li><a href="#binning-data">2.5 Binning data</a></li>
      <li><a href="#accounting-for-site-to-site-variability">2.6 Accounting for site-to-site variability</a></li>
      </ul>
</li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Fabiola Iannarilli, John R Fieberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.0.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
